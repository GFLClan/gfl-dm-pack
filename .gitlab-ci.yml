image:
  name: registry.gitlab.com/dreae/sourcemod-build:latest
  entrypoint: ["/bin/bash", "-c"]

build:
  script:
  - dnf -y install make
  - mkdir compiled
  - make CC=/sourcemod/scripting/spcomp INCLUDE="-i /sourcemod/scripting/include -i include" all
  - mkdir plugins
  - cp compiled/*.smx plugins/
  - mkdir scripting
  - cp *.sp scripting/
  - cp -r include/ scripting/
  artifacts:
    paths:
      - plugins/
      - translations/
      - sound/
      - scripting/